# Demo Installer Configuration
# This example demonstrates the go-pkg-installer framework

product:
  name: "简易玲珑商店安装包"
  logo: "assets/logo.png"
  theme:
    primaryColor: "#2196F3"

# Global metadata
meta:
  version: "1.0.0"
  vendor: "Linyaps Simple Store SIG"
  min_disk_mb: 100

# Define workflows
flows:
  # Main installation flow
  install:
    entry: welcome
    steps:
      - id: welcome
        title: "欢迎"
        screen:
          type: welcome
          content: |

            此向导将引导您完成简易玲珑商店的安装。


      # - id: destination
      #   title: "安装目录"
      #   screen:
      #     type: pathPicker
      #     bind: install_dir

      - id: options
        title: "检查玲珑环境"
        screen:
          type: options
          bind: install_options
          options:
            - label: "Create desktop shortcut"
              value: "desktop_shortcut"
            - label: "Add to PATH"
              value: "add_to_path"
            - label: "Start after installation"
              value: "start_after"

      - id: summary
        title: "准备安装"
        screen:
          type: summary

      - id: progress
        title: "正在安装"
        screen:
          type: progress
        tasks:
          - type: shell
            script: |
              mkdir -p "${install_dir}"

          - type: writeConfig
            path: "${install_dir}/README.txt"
            content: |
              Demo Application
              ================

              Thank you for installing Demo Application!

              Installation Directory: ${install_dir}

          - type: shell
            script: |
              cat > "${install_dir}/config.json" << 'EOF'
              {
                "app_name": "Demo Application",
                "version": "1.0.0"
              }
              EOF

          - type: shell
            script: |
              cat > "${install_dir}/demo-app.sh" << 'EOF'
              #!/bin/bash
              echo "Demo Application v1.0.0"
              echo "Hello from go-pkg-installer!"
              EOF
              chmod +x "${install_dir}/demo-app.sh"

      - id: finish
        title: "完成"
        screen:
          type: finish

  # Uninstall flow
  uninstall:
    entry: uninstall_welcome
    steps:
      - id: uninstall_welcome
        title: "Uninstall"
        screen:
          type: welcome
          content: |
            This wizard will remove Demo Application from your system.

            Click Next to continue.

      - id: uninstall_confirm
        title: "Confirm"
        screen:
          type: summary

      - id: uninstall_progress
        title: "Uninstalling"
        screen:
          type: progress
        tasks:
          - type: removePath
            path: "${install_dir}"
            recursive: true

      - id: uninstall_complete
        title: "Complete"
        screen:
          type: finish
